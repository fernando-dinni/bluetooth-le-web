<!DOCTYPE html>
<html>
<head>
    <title>Bluetooth LE</title>
    <script>
        async function connectToBluetooth() {
            try {
                const device = await navigator.bluetooth.requestDevice({
                    acceptAllDevices: true,
                    optionalServices: ['battery_service']
                });

                const server = await device.gatt.connect();
                console.log('Connected to GATT server');

                const service = await server.getPrimaryService('battery_service');
                const characteristic = await service.getCharacteristic('battery_level');
                const value = await characteristic.readValue();
                console.log('Battery level:', value.getUint8(0));
                
                window.ReactNativeWebView.postMessage(JSON.stringify({ type: 'battery_level', value: value.getUint8(0) }));
            } catch (error) {
                console.log('Error:', error);
                window.ReactNativeWebView.postMessage(JSON.stringify({ type: 'error', message: error.message }));
            }
        }

        window.onload = () => {
            document.getElementById('connectButton').addEventListener('click', connectToBluetooth);
        };
    </script>
</head>
<body>
    <h1>Bluetooth LE Example</h1>
    <button id="connectButton">Connect to Bluetooth</button>
</body>
</html>
